# Ralph Progress Log

## 2026-01-24 - ENG-8: Add HTMX support to Phoenix project

### What was implemented
- Added HTMX library to Phoenix project (vendor approach)
- Created HtmxController with two demo endpoints: `/htmx/greeting` and `/htmx/roll`
- Configured HTMX to include CSRF tokens in all requests
- Updated home page with interactive HTMX demo section
- Created comprehensive tests for HTMX endpoints

### Files changed
- `assets/vendor/htmx.min.js` (new) - HTMX library v2.0.4
- `assets/js/app.js` - Added HTMX import and CSRF configuration
- `lib/whimsy_web/router.ex` - Added HTMX route scope
- `lib/whimsy_web/controllers/htmx_controller.ex` (new) - HTMX endpoints
- `lib/whimsy_web/controllers/htmx_html.ex` (new) - HTML module for fragments
- `lib/whimsy_web/controllers/htmx_html/greeting.html.heex` (new) - Greeting fragment
- `lib/whimsy_web/controllers/htmx_html/dice_result.html.heex` (new) - Dice roll fragment
- `lib/whimsy_web/controllers/page_html/home.html.heex` - Added HTMX demo section
- `test/whimsy_web/controllers/htmx_controller_test.exs` (new) - Controller tests

### Learnings
- **Layout gotcha**: `put_layout(false)` alone is NOT enough for HTML fragments. Must also use `put_root_layout(false)` to prevent Phoenix from wrapping response in full HTML document.
- **Vendor libraries**: Phoenix project uses vendor libraries in `assets/vendor/` rather than npm packages. Simpler approach for small projects.
- **CSRF for HTMX**: HTMX needs to be configured to send CSRF token in request headers via `htmx:configRequest` event listener.
- **HEEx templates**: Templates embed automatically when using `embed_templates "directory/*"` pattern.
- **No npm in assets**: This project doesn't have package.json, typecheck via npm is not applicable.

---

